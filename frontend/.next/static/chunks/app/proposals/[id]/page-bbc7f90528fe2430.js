(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4566],{32582:function(e,t,n){Promise.resolve().then(n.bind(n,38113))},38113:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return j}});var a=n(57437),s=n(99376),r=n(64707),i=n(27323),o=n(46003),u=n(97269),d=n(66070),l=n(62869),c=n(35974),p=n(47170),m=n(94508),y=n(29827),f=n(51817),g=n(38060),b=n(79205);let x=(0,b.Z)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),h=(0,b.Z)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);var v=n(2265);function j(){var e;let t=(0,s.useParams)().id,{address:n,isConnected:b}=(0,r.m)(),{data:j}=(0,i.u)({address:p.qE.voting.address,abi:p.qE.voting.abi,functionName:"getProposal",args:[t]}),{data:w}=(0,i.u)({address:p.qE.voting.address,abi:p.qE.voting.abi,functionName:"getProposalResults",args:[t]}),{data:k}=(0,i.u)({address:p.qE.voting.address,abi:p.qE.voting.abi,functionName:"getVoterInfo",args:n&&t?[t,n]:void 0}),{data:C}=(0,i.u)({address:p.qE.voting.address,abi:p.qE.voting.abi,functionName:"getLockedTokens",args:n&&t?[t,n]:void 0}),{data:E}=(0,i.u)({address:p.qE.token.address,abi:p.qE.token.abi,functionName:"balanceOf",args:n?[n]:void 0}),[S,q]=(0,v.useState)(null),{writeContract:M,data:L,isPending:P,error:V}=(0,o.S)(),{isLoading:Z}=(0,u.A)({hash:L}),O=(0,y.NL)(),{writeContract:T,data:A,isPending:D}=(0,o.S)(),{isLoading:I}=(0,u.A)({hash:A}),{writeContract:F,data:B,isPending:R}=(0,o.S)(),{isLoading:z}=(0,u.A)({hash:B}),{writeContract:H,data:Y,isPending:_}=(0,o.S)(),{isLoading:Q}=(0,u.A)({hash:Y}),W=()=>{O.invalidateQueries({queryKey:["readContract"]})};if(!j)return(0,a.jsx)("div",{className:"flex items-center justify-center py-20",children:(0,a.jsx)(f.Z,{className:"h-8 w-8 animate-spin text-muted-foreground"})});let[U,G,K,$,J,X,ee,et,en,ea,es,er,ei,eo,eu,ed,el]=j,ec=Math.floor(Date.now()/1e3),ep=ec>=Number($),em=ec>=Number(J),ey=!!(b&&n&&ep&&!em&&k&&!k[0]&&void 0!==E&&E>=BigInt(100*1e18)),ef=Number(eu),eg=null!==(e=p.So[ef])&&void 0!==e?e:"Unknown",eb=em&&!ea,ex=ea&&3===ef&&!et&&"0x0000000000000000000000000000000000000000"!==es&&ec>Number(J)+Number(ei)&&ec<=Number(eo),eh=(2===ef||5===ef||6===ef||3===ef&&(et||ec>Number(eo)))&&void 0!==C&&C>0n;return(0,a.jsxs)("div",{className:"space-y-8 animate-fade-in",children:[(0,a.jsx)("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-4",children:(0,a.jsxs)("div",{children:[(0,a.jsx)(c.C,{variant:1===ef?"warning":3===ef||4===ef?"success":2===ef||5===ef||6===ef?"destructive":"secondary",className:"mb-2",children:eg}),(0,a.jsx)("h1",{className:"text-2xl md:text-3xl font-bold tracking-tight",children:G||"Untitled proposal"}),(0,a.jsxs)("p",{className:"text-muted-foreground mt-1",children:["Created by ",(0,m.Tg)(K)]})]})}),(0,a.jsxs)("div",{className:"grid gap-6 md:grid-cols-2",children:[(0,a.jsxs)(d.Zb,{children:[(0,a.jsx)(d.Ol,{children:(0,a.jsx)(d.ll,{className:"text-base",children:"Details"})}),(0,a.jsxs)(d.aY,{className:"space-y-2 text-sm",children:[(0,a.jsxs)("p",{children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Start:"})," ",(0,m.p6)($)]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"End:"})," ",(0,m.p6)(J)]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Total votes:"})," ",(0,m.LH)(en)]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Options:"})," ",ee.length]}),ea&&w&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("p",{children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Quorum met:"})," ",w[5]?"Yes":"No"]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Threshold met:"})," ",w[4]?"Yes":"No"]}),w[0]&&w[0].length>0&&(0,a.jsxs)("p",{children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Winner option:"})," ",w[0][0].toString()]})]})]})]}),(0,a.jsxs)(d.Zb,{children:[(0,a.jsx)(d.Ol,{children:(0,a.jsx)(d.ll,{className:"text-base",children:"Your participation"})}),(0,a.jsx)(d.aY,{className:"space-y-2 text-sm",children:b?k?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("p",{children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Voted:"})," ",k[0]?"Yes":"No"]}),k[0]&&(0,a.jsxs)("p",{children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Option:"})," ",k[2].toString()," \xb7 Weight: ",(0,m.LH)(k[1])]}),void 0!==C&&C>0n&&(0,a.jsxs)("p",{children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Locked:"})," ",(0,m.LH)(C)," GOV"]})]}):null:(0,a.jsx)("p",{className:"text-muted-foreground",children:"Connect wallet to see your status."})})]})]}),(0,a.jsxs)(d.Zb,{children:[(0,a.jsxs)(d.Ol,{children:[(0,a.jsx)(d.ll,{className:"text-base",children:"Options & votes"}),(0,a.jsx)(d.SZ,{children:ea?"Final results":em?"Voting ended â€” calculate results to see final counts":"Current vote counts"})]}),(0,a.jsx)(d.aY,{children:(0,a.jsx)("ul",{className:"space-y-3",children:ee.map((e,n)=>{var s;return(0,a.jsx)(N,{proposalId:t,option:e,resultVoteCount:w?null===(s=w[1])||void 0===s?void 0:s[n]:void 0,totalVotes:w?w[2]:en,canVote:ey,selectedOption:S,setSelectedOption:q},n)})})})]}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-3",children:[ey&&(0,a.jsxs)(l.z,{onClick:()=>{null!==S&&t&&M({address:p.qE.voting.address,abi:p.qE.voting.abi,functionName:"vote",args:[t,S,0n,p.qZ.Balance]},{onSuccess:W})},disabled:null===S||P||Z,children:[P||Z?(0,a.jsx)(f.Z,{className:"h-4 w-4 animate-spin mr-2"}):(0,a.jsx)(g.Z,{className:"h-4 w-4 mr-2"}),"Vote"]}),eb&&(0,a.jsxs)(l.z,{variant:"secondary",onClick:()=>{T({address:p.qE.voting.address,abi:p.qE.voting.abi,functionName:"calculateResults",args:[t]},{onSuccess:W})},disabled:D||I,children:[(D||I)&&(0,a.jsx)(f.Z,{className:"h-4 w-4 animate-spin mr-2"}),"Calculate results"]}),ex&&(0,a.jsxs)(l.z,{onClick:()=>{F({address:p.qE.voting.address,abi:p.qE.voting.abi,functionName:"executeProposal",args:[t]},{onSuccess:W})},disabled:R||z,children:[R||z?(0,a.jsx)(f.Z,{className:"h-4 w-4 animate-spin mr-2"}):(0,a.jsx)(x,{className:"h-4 w-4 mr-2"}),"Execute proposal"]}),eh&&(0,a.jsxs)(l.z,{variant:"outline",onClick:()=>{H({address:p.qE.voting.address,abi:p.qE.voting.abi,functionName:"withdrawLockedTokens",args:[t]},{onSuccess:W})},disabled:_||Q,children:[(_||Q)&&(0,a.jsx)(f.Z,{className:"h-4 w-4 animate-spin mr-2"}),"Withdraw locked tokens"]})]}),V&&(0,a.jsxs)("div",{className:"flex items-center gap-2 text-destructive text-sm",children:[(0,a.jsx)(h,{className:"h-4 w-4 shrink-0"}),V.message]})]})}function N(e){var t;let{proposalId:n,option:s,resultVoteCount:r,totalVotes:o,canVote:u,selectedOption:d,setSelectedOption:l}=e,{data:c}=(0,i.u)({address:p.qE.voting.address,abi:p.qE.voting.abi,functionName:"getVoteCount",args:[n,s]}),y=null!==(t=null!=r?r:c)&&void 0!==t?t:0n,f=o>0n?Number(10000n*y/o)/100:0;return(0,a.jsxs)("li",{className:"flex items-center justify-between rounded-lg border p-3 ".concat(d===s?"border-primary bg-primary/10":""),children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[u&&(0,a.jsx)("button",{type:"button",onClick:()=>l(s),className:"h-4 w-4 rounded-full border-2 border-primary bg-background flex items-center justify-center hover:bg-primary/20",children:d===s&&(0,a.jsx)("div",{className:"h-2 w-2 rounded-full bg-primary"})}),(0,a.jsxs)("span",{className:"font-medium",children:["Option ",s.toString()]})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("span",{className:"font-mono text-sm",children:[(0,m.LH)(y)," votes"]}),o>0n&&(0,a.jsxs)("span",{className:"text-muted-foreground text-sm ml-2",children:["(",f,"%)"]})]})]})}},35974:function(e,t,n){"use strict";n.d(t,{C:function(){return o}});var a=n(57437);n(2265);var s=n(90535),r=n(94508);let i=(0,s.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground",success:"border-transparent bg-emerald-500/20 text-emerald-400 border-emerald-500/30",warning:"border-transparent bg-amber-500/20 text-amber-400 border-amber-500/30"}},defaultVariants:{variant:"default"}});function o(e){let{className:t,variant:n,...s}=e;return(0,a.jsx)("div",{className:(0,r.cn)(i({variant:n}),t),...s})}},62869:function(e,t,n){"use strict";n.d(t,{z:function(){return d}});var a=n(57437),s=n(2265),r=n(85293),i=n(90535),o=n(94508);let u=(0,i.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=s.forwardRef((e,t)=>{let{className:n,variant:s,size:i,asChild:d=!1,...l}=e,c=d?r.g7:"button";return(0,a.jsx)(c,{className:(0,o.cn)(u({variant:s,size:i,className:n})),ref:t,...l})});d.displayName="Button"},66070:function(e,t,n){"use strict";n.d(t,{Ol:function(){return o},SZ:function(){return d},Zb:function(){return i},aY:function(){return l},ll:function(){return u}});var a=n(57437),s=n(2265),r=n(94508);let i=s.forwardRef((e,t)=>{let{className:n,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,r.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",n),...s})});i.displayName="Card";let o=s.forwardRef((e,t)=>{let{className:n,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,r.cn)("flex flex-col space-y-1.5 p-6",n),...s})});o.displayName="CardHeader";let u=s.forwardRef((e,t)=>{let{className:n,...s}=e;return(0,a.jsx)("h3",{ref:t,className:(0,r.cn)("text-2xl font-semibold leading-none tracking-tight",n),...s})});u.displayName="CardTitle";let d=s.forwardRef((e,t)=>{let{className:n,...s}=e;return(0,a.jsx)("p",{ref:t,className:(0,r.cn)("text-sm text-muted-foreground",n),...s})});d.displayName="CardDescription";let l=s.forwardRef((e,t)=>{let{className:n,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,r.cn)("p-6 pt-0",n),...s})});l.displayName="CardContent",s.forwardRef((e,t)=>{let{className:n,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,r.cn)("flex items-center p-6 pt-0",n),...s})}).displayName="CardFooter"},47170:function(e,t,n){"use strict";n.d(t,{So:function(){return s},qE:function(){return a},qZ:function(){return r}});let a={token:{address:"0xe1267DBA9e3E3749aAF1eFfbC3C4D409f4CbF7Bf",abi:[{inputs:[{name:"account",type:"address"}],name:"balanceOf",outputs:[{name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"decimals",outputs:[{name:"",type:"uint8"}],stateMutability:"view",type:"function"},{inputs:[],name:"symbol",outputs:[{name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[{name:"owner",type:"address"},{name:"spender",type:"address"}],name:"allowance",outputs:[{name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{name:"spender",type:"address"},{name:"amount",type:"uint256"}],name:"approve",outputs:[{name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"}]},voting:{address:"0xF51F3bD4C08b510e704058694AD59B690784055F",abi:[{inputs:[],name:"minBalance",outputs:[{name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"defaultQuorum",outputs:[{name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"votingToken",outputs:[{name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"getAllProposals",outputs:[{name:"",type:"bytes32[]"}],stateMutability:"view",type:"function"},{inputs:[{name:"offset",type:"uint256"},{name:"limit",type:"uint256"}],name:"getProposalsPaginated",outputs:[{name:"proposals_",type:"bytes32[]"}],stateMutability:"view",type:"function"},{inputs:[{name:"proposalId",type:"bytes32"}],name:"getProposal",outputs:[{name:"id",type:"bytes32"},{name:"description",type:"string"},{name:"creator",type:"address"},{name:"startTime",type:"uint256"},{name:"endTime",type:"uint256"},{name:"snapshotBlock",type:"uint256"},{name:"options",type:"uint256[]"},{name:"executed",type:"bool"},{name:"totalVotes",type:"uint256"},{name:"resultsCalculated",type:"bool"},{name:"target",type:"address"},{name:"data",type:"bytes"},{name:"timeLockDuration",type:"uint256"},{name:"executionDeadline",type:"uint256"},{name:"state",type:"uint8"},{name:"customThreshold",type:"uint256"},{name:"customQuorum",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{name:"proposalId",type:"bytes32"}],name:"getProposalResults",outputs:[{name:"winners",type:"uint256[]"},{name:"voteCounts",type:"uint256[]"},{name:"totalVotes",type:"uint256"},{name:"tie",type:"bool"},{name:"noVotes",type:"bool"},{name:"thresholdMet",type:"bool"},{name:"quorumMet",type:"bool"},{name:"calculatedAt",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{name:"proposalId",type:"bytes32"},{name:"option",type:"uint256"}],name:"getVoteCount",outputs:[{name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{name:"proposalId",type:"bytes32"},{name:"voter",type:"address"}],name:"getVoterInfo",outputs:[{name:"hasVoted",type:"bool"},{name:"weight",type:"uint256"},{name:"votedOption",type:"uint256"},{name:"snapshotPower",type:"uint256"},{name:"delegatedPower",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{name:"proposalId",type:"bytes32"},{name:"voter",type:"address"}],name:"getLockedTokens",outputs:[{name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{name:"description",type:"string"},{name:"startTime",type:"uint256"},{name:"endTime",type:"uint256"},{name:"options",type:"uint256[]"},{name:"target",type:"address"},{name:"data",type:"bytes"},{name:"timeLockDuration_",type:"uint256"},{name:"customThreshold",type:"uint256"},{name:"customQuorum",type:"uint256"}],name:"createProposal",outputs:[{name:"",type:"bytes32"}],stateMutability:"nonpayable",type:"function"},{inputs:[{name:"proposalId",type:"bytes32"},{name:"option",type:"uint256"},{name:"weight",type:"uint256"},{name:"powerSource",type:"uint8"}],name:"vote",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{name:"proposalId",type:"bytes32"}],name:"calculateResults",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{name:"proposalId",type:"bytes32"}],name:"executeProposal",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{name:"proposalId",type:"bytes32"}],name:"withdrawLockedTokens",outputs:[],stateMutability:"nonpayable",type:"function"}]},target:{address:"0xC799F442F85D4d28DA377342F30C39041b9c102A"}},s=["Pending","Active","Defeated","Succeeded","Executed","Canceled","Expired"],r={Balance:0,Snapshot:1,Delegated:2}},94508:function(e,t,n){"use strict";n.d(t,{LH:function(){return o},Tg:function(){return i},cn:function(){return r},p6:function(){return u}});var a=n(61994),s=n(53335);function r(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,s.m6)((0,a.W)(t))}function i(e){return!e||e.length<10?e:"".concat(e.slice(0,6),"...").concat(e.slice(-4))}function o(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:18,n=10n**BigInt(t),a=e/n,s=(e%n).toString().padStart(t,"0").slice(0,4).replace(/0+$/,"");return s?"".concat(a,".").concat(s):a.toString()}function u(e){return new Date(1e3*Number(e)).toLocaleString(void 0,{dateStyle:"medium",timeStyle:"short"})}},38060:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});let a=(0,n(79205).Z)("Vote",[["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}],["path",{d:"M5 7c0-1.1.9-2 2-2h10a2 2 0 0 1 2 2v12H5V7Z",key:"1ezoue"}],["path",{d:"M22 19H2",key:"nuriw5"}]])}},function(e){e.O(0,[6440,5383,7632,2971,2117,1744],function(){return e(e.s=32582)}),_N_E=e.O()}]);